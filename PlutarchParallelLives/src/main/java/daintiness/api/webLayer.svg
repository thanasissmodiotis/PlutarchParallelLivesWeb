<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 700" width="1000" height="700">
  <defs>
    <style>
      .class-box { fill: white; stroke: black; stroke-width: 1.5; }
      .interface-box { fill: #FFFEF0; stroke: black; stroke-width: 1.5; }
      .class-header { fill: #E8E8E8; stroke: black; stroke-width: 1; }
      .interface-header { fill: #E8F0E8; stroke: black; stroke-width: 1; }
      .package-box { fill: #FAFAFA; stroke: #999999; stroke-width: 1; stroke-dasharray: 5,3; }
      .class-name { font-family: Arial, sans-serif; font-size: 12px; font-weight: bold; }
      .stereotype { font-family: Arial, sans-serif; font-size: 10px; font-style: italic; }
      .attribute { font-family: Arial, sans-serif; font-size: 10px; }
      .operation { font-family: Arial, sans-serif; font-size: 10px; }
      .package-name { font-family: Arial, sans-serif; font-size: 11px; font-weight: bold; }
      .arrow { fill: none; stroke: black; stroke-width: 1; }
      .dependency { fill: none; stroke: black; stroke-width: 1; stroke-dasharray: 5,3; }
      .note-box { fill: #FFFFCC; stroke: #999900; stroke-width: 1; }
      .note-text { font-family: Arial, sans-serif; font-size: 9px; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="black" />
    </marker>
    <marker id="diamond" markerWidth="12" markerHeight="12" refX="0" refY="6" orient="auto">
      <path d="M0,6 L6,0 L12,6 L6,12 z" fill="white" stroke="black" stroke-width="1"/>
    </marker>
    <marker id="triangle" markerWidth="15" markerHeight="15" refX="0" refY="6" orient="auto">
      <path d="M0,0 L0,12 L12,6 z" fill="white" stroke="black" stroke-width="1"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1000" height="700" fill="white"/>

  <!-- Title -->
  <text x="500" y="25" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold">
    Web Layer Architecture - daintiness.api
  </text>

  <!-- Package: daintiness.api (NEW) -->
  <rect x="20" y="40" width="450" height="350" class="package-box" fill="#E8F4FD"/>
  <text x="30" y="55" class="package-name">daintiness.api (NEW - Web Layer)</text>

  <!-- Class: DaintinessRestAPI -->
  <g transform="translate(40, 70)">
    <rect x="0" y="0" width="200" height="180" class="class-box"/>
    <rect x="0" y="0" width="200" height="40" class="class-header"/>
    <text x="100" y="15" text-anchor="middle" class="stereotype">&lt;&lt;@RestController&gt;&gt;</text>
    <text x="100" y="32" text-anchor="middle" class="class-name">DaintinessRestAPI</text>
    <line x1="0" y1="40" x2="200" y2="40" stroke="black"/>
    <text x="5" y="55" class="attribute">- projectStore: ProjectStore</text>
    <line x1="0" y1="62" x2="200" y2="62" stroke="black"/>
    <text x="5" y="75" class="operation">+ createProject()</text>
    <text x="5" y="88" class="operation">+ deleteProject()</text>
    <text x="5" y="101" class="operation">+ loadFile()</text>
    <text x="5" y="114" class="operation">+ clusterData()</text>
    <text x="5" y="127" class="operation">+ getChartData()</text>
    <text x="5" y="140" class="operation">+ sortChartData()</text>
    <text x="5" y="153" class="operation">+ getPatterns()</text>
    <text x="5" y="166" class="operation">+ exportProject()</text>
    <text x="5" y="179" class="operation">... (14 endpoints total)</text>
  </g>

  <!-- Class: ProjectStore -->
  <g transform="translate(270, 70)">
    <rect x="0" y="0" width="180" height="120" class="class-box"/>
    <rect x="0" y="0" width="180" height="40" class="class-header"/>
    <text x="90" y="15" text-anchor="middle" class="stereotype">&lt;&lt;@Component&gt;&gt;</text>
    <text x="90" y="32" text-anchor="middle" class="class-name">ProjectStore</text>
    <line x1="0" y1="40" x2="180" y2="40" stroke="black"/>
    <text x="5" y="55" class="attribute">- projects: ConcurrentMap</text>
    <text x="5" y="68" class="attribute">- factory: MainControllerFactory</text>
    <line x1="0" y1="75" x2="180" y2="75" stroke="black"/>
    <text x="5" y="90" class="operation">+ createProject(): String</text>
    <text x="5" y="103" class="operation">+ get(): Optional&lt;IMainController&gt;</text>
    <text x="5" y="116" class="operation">+ delete(): boolean</text>
  </g>

  <!-- Class: ClusteringRequest (inner) -->
  <g transform="translate(40, 270)">
    <rect x="0" y="0" width="150" height="100" class="class-box"/>
    <rect x="0" y="0" width="150" height="30" class="class-header"/>
    <text x="75" y="12" text-anchor="middle" class="stereotype">&lt;&lt;DTO&gt;&gt;</text>
    <text x="75" y="25" text-anchor="middle" class="class-name">ClusteringRequest</text>
    <line x1="0" y1="30" x2="150" y2="30" stroke="black"/>
    <text x="5" y="45" class="attribute">- numberOfPhases: int</text>
    <text x="5" y="58" class="attribute">- numberOfEntityGroups: int</text>
    <text x="5" y="71" class="attribute">- changesWeight: double</text>
    <text x="5" y="84" class="attribute">- timeClusteringEnabled</text>
    <text x="5" y="97" class="attribute">- entityClusteringEnabled</text>
  </g>

  <!-- Class: ChartDataRequest (inner) -->
  <g transform="translate(210, 270)">
    <rect x="0" y="0" width="140" height="80" class="class-box"/>
    <rect x="0" y="0" width="140" height="30" class="class-header"/>
    <text x="70" y="12" text-anchor="middle" class="stereotype">&lt;&lt;DTO&gt;&gt;</text>
    <text x="70" y="25" text-anchor="middle" class="class-name">ChartDataRequest</text>
    <line x1="0" y1="30" x2="140" y2="30" stroke="black"/>
    <text x="5" y="45" class="attribute">- measurementType: String</text>
    <text x="5" y="58" class="attribute">- aggregationType: String</text>
    <line x1="0" y1="65" x2="140" y2="65" stroke="black"/>
    <text x="5" y="78" class="operation">+ getters/setters</text>
  </g>

  <!-- Package: daintiness.maincontroller -->
  <rect x="490" y="40" width="250" height="200" class="package-box"/>
  <text x="500" y="55" class="package-name">daintiness.maincontroller</text>

  <!-- Interface: IMainController -->
  <g transform="translate(510, 70)">
    <rect x="0" y="0" width="210" height="150" class="interface-box"/>
    <rect x="0" y="0" width="210" height="30" class="interface-header"/>
    <text x="105" y="12" text-anchor="middle" class="stereotype">&lt;&lt;interface&gt;&gt;</text>
    <text x="105" y="25" text-anchor="middle" class="class-name">IMainController</text>
    <line x1="0" y1="30" x2="210" y2="30" stroke="black"/>
    <text x="5" y="45" class="operation">+ load(inputFile: File)</text>
    <text x="5" y="58" class="operation">+ save(outputFile: File)</text>
    <text x="5" y="71" class="operation">+ getPhases(): List&lt;Phase&gt;</text>
    <text x="5" y="84" class="operation">+ getEntityGroups(): List</text>
    <text x="5" y="97" class="operation">+ getChartData(): ObservableList</text>
    <text x="5" y="110" class="operation">+ clusterData(profile)</text>
    <text x="5" y="123" class="operation">+ sortChartData(type)</text>
    <text x="5" y="136" class="operation">+ getPatterns(type): List</text>
    <text x="5" y="149" class="operation">... (17 methods total)</text>
  </g>

  <!-- Package: daintiness.clustering -->
  <rect x="490" y="260" width="250" height="130" class="package-box"/>
  <text x="500" y="275" class="package-name">daintiness.clustering</text>

  <!-- Class: Phase -->
  <g transform="translate(510, 290)">
    <rect x="0" y="0" width="100" height="50" class="class-box"/>
    <rect x="0" y="0" width="100" height="25" class="class-header"/>
    <text x="50" y="17" text-anchor="middle" class="class-name">Phase</text>
    <line x1="0" y1="25" x2="100" y2="25" stroke="black"/>
    <text x="5" y="40" class="attribute">- phaseId: int</text>
  </g>

  <!-- Class: EntityGroup -->
  <g transform="translate(620, 290)">
    <rect x="0" y="0" width="100" height="50" class="class-box"/>
    <rect x="0" y="0" width="100" height="25" class="class-header"/>
    <text x="50" y="17" text-anchor="middle" class="class-name">EntityGroup</text>
    <line x1="0" y1="25" x2="100" y2="25" stroke="black"/>
    <text x="5" y="40" class="attribute">- entityGroupId</text>
  </g>

  <!-- Class: ClusteringProfile -->
  <g transform="translate(510, 350)">
    <rect x="0" y="0" width="210" height="35" class="class-box"/>
    <rect x="0" y="0" width="210" height="25" class="class-header"/>
    <text x="105" y="17" text-anchor="middle" class="class-name">ClusteringProfile</text>
    <line x1="0" y1="25" x2="210" y2="25" stroke="black"/>
  </g>

  <!-- Package: daintiness.models -->
  <rect x="760" y="260" width="220" height="80" class="package-box"/>
  <text x="770" y="275" class="package-name">daintiness.models</text>

  <!-- Class: PatternData -->
  <g transform="translate(780, 290)">
    <rect x="0" y="0" width="180" height="40" class="class-box"/>
    <rect x="0" y="0" width="180" height="25" class="class-header"/>
    <text x="90" y="17" text-anchor="middle" class="class-name">PatternData</text>
    <line x1="0" y1="25" x2="180" y2="25" stroke="black"/>
  </g>

  <!-- Relationships -->
  
  <!-- DaintinessRestAPI -> ProjectStore -->
  <line x1="240" y1="160" x2="270" y2="160" class="arrow" marker-end="url(#arrow)"/>
  <text x="245" y="152" class="attribute">@Autowired</text>

  <!-- ProjectStore -> IMainController -->
  <line x1="450" y1="130" x2="510" y2="130" class="arrow" marker-end="url(#arrow)"/>
  <text x="455" y="122" class="attribute">stores *</text>

  <!-- DaintinessRestAPI -> IMainController (dependency) -->
  <path d="M 240 180 Q 380 180 510 170" class="dependency" marker-end="url(#arrow)"/>
  <text x="360" y="195" class="attribute">uses</text>

  <!-- Nesting: DaintinessRestAPI -> ClusteringRequest -->
  <line x1="115" y1="250" x2="115" y2="270" class="arrow"/>
  <circle cx="115" cy="258" r="5" fill="white" stroke="black"/>
  <line x1="112" y1="258" x2="118" y2="258" stroke="black"/>

  <!-- Nesting: DaintinessRestAPI -> ChartDataRequest -->
  <line x1="210" y1="250" x2="280" y2="270" class="arrow"/>
  <circle cx="245" cy="260" r="5" fill="white" stroke="black"/>
  <line x1="242" y1="260" x2="248" y2="260" stroke="black"/>

  <!-- DaintinessRestAPI -> Phase (dependency) -->
  <path d="M 240 200 Q 400 280 510 310" class="dependency" marker-end="url(#arrow)"/>

  <!-- DaintinessRestAPI -> EntityGroup (dependency) -->
  <path d="M 240 210 Q 430 290 620 310" class="dependency" marker-end="url(#arrow)"/>

  <!-- DaintinessRestAPI -> PatternData (dependency) -->
  <path d="M 240 220 Q 500 300 780 310" class="dependency" marker-end="url(#arrow)"/>

  <!-- DaintinessRestAPI -> ClusteringProfile (dependency) -->
  <path d="M 190 250 Q 350 340 510 365" class="dependency" marker-end="url(#arrow)"/>

  <!-- Note Box -->
  <g transform="translate(760, 40)">
    <rect x="0" y="0" width="220" height="180" class="note-box"/>
    <text x="10" y="20" class="note-text" font-weight="bold">REST API Endpoints:</text>
    <text x="10" y="35" class="note-text">POST   /api/projects</text>
    <text x="10" y="48" class="note-text">DELETE /api/projects/{id}</text>
    <text x="10" y="61" class="note-text">POST   .../load</text>
    <text x="10" y="74" class="note-text">POST   .../loadSchemaEvo</text>
    <text x="10" y="87" class="note-text">POST   .../importProject</text>
    <text x="10" y="100" class="note-text">POST   .../exportProject</text>
    <text x="10" y="113" class="note-text">GET    .../info</text>
    <text x="10" y="126" class="note-text">POST   .../cluster</text>
    <text x="10" y="139" class="note-text">GET    .../chartData</text>
    <text x="10" y="152" class="note-text">POST   .../sort</text>
    <text x="10" y="165" class="note-text">GET    .../patterns</text>
    <text x="10" y="178" class="note-text">+ 3 more endpoints</text>
  </g>

  <!-- Legend -->
  <g transform="translate(20, 420)">
    <text x="0" y="0" font-family="Arial" font-size="12" font-weight="bold">Legend:</text>
    
    <!-- Association -->
    <line x1="0" y1="20" x2="50" y2="20" class="arrow" marker-end="url(#arrow)"/>
    <text x="60" y="24" class="attribute">Association</text>
    
    <!-- Dependency -->
    <line x1="0" y1="40" x2="50" y2="40" class="dependency" marker-end="url(#arrow)"/>
    <text x="60" y="44" class="attribute">Dependency (uses)</text>
    
    <!-- Nesting -->
    <line x1="0" y1="60" x2="50" y2="60" stroke="black"/>
    <circle cx="25" cy="60" r="5" fill="white" stroke="black"/>
    <line x1="22" y1="60" x2="28" y2="60" stroke="black"/>
    <text x="60" y="64" class="attribute">Nesting (inner class)</text>
    
    <!-- Class Box -->
    <rect x="0" y="75" width="50" height="20" class="class-box"/>
    <text x="60" y="89" class="attribute">Class</text>
    
    <!-- Interface Box -->
    <rect x="0" y="100" width="50" height="20" class="interface-box"/>
    <text x="60" y="114" class="attribute">Interface</text>
  </g>

  <!-- Footer -->
  <text x="500" y="690" text-anchor="middle" font-family="Arial" font-size="10" fill="#666">
    PlutarchParallelLives - Spring Boot Web Layer UML Diagram
  </text>
</svg>
